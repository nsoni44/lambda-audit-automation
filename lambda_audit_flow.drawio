<?xml version="1.0" encoding="UTF-8"?>
<mxfile host="app.diagrams.net" modified="2026-02-14T22:56:00.000Z" agent="Mozilla/5.0" version="20.6.3" editor="draw.io">
  <diagram id="lambda-audit-flow" name="Lambda Security Audit Architecture">
    <mxGraphModel dx="1420" dy="920" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1200" pageHeight="1400" math="0" shadow="0">
      <root>
        <mxCell id="0"/>
        <mxCell id="1" parent="0"/>

        <!-- TITLE -->
        <mxCell id="title" value="Lambda Security Audit Automation - Complete Workflow" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=18;fontStyle=1;fontColor=#1f77b4;" vertex="1" parent="1">
          <mxGeometry x="50" y="10" width="1100" height="40" as="geometry"/>
        </mxCell>

        <!-- ===== PHASE 1: INPUT ===== -->
        <mxCell id="phase1-label" value="PHASE 1: CONFIGURATION &amp; DISCOVERY" style="text;html=1;strokeColor=none;fillColor=#e3f2fd;align=center;verticalAlign=middle;fontSize=12;fontStyle=1;fontColor=#1565c0;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="50" y="70" width="1100" height="25" as="geometry"/>
        </mxCell>

        <!-- Load Config -->
        <mxCell id="load-config" value="ðŸ“‹ Load Config&#10;credentials.json" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#bbdefb;strokeColor=#1976d2;strokeWidth=2;fontSize=11;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="70" y="120" width="150" height="70" as="geometry"/>
        </mxCell>

        <!-- Initialize AWS Client -->
        <mxCell id="init-aws" value="ðŸ” Init AWS Client&#10;(ConfigManager)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#bbdefb;strokeColor=#1976d2;strokeWidth=2;fontSize=11;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="260" y="120" width="150" height="70" as="geometry"/>
        </mxCell>

        <!-- List Lambda Functions -->
        <mxCell id="list-funcs" value="ðŸ“œ List Lambda&#10;Functions" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#bbdefb;strokeColor=#1976d2;strokeWidth=2;fontSize=11;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="450" y="120" width="150" height="70" as="geometry"/>
        </mxCell>

        <!-- Check Functions Decision -->
        <mxCell id="decision-funcs" value="Functions&#10;Found?" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fff9c4;strokeColor=#f57f17;strokeWidth=2;fontSize=11;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="680" y="120" width="130" height="70" as="geometry"/>
        </mxCell>

        <!-- No functions path -->
        <mxCell id="end-empty" value="âŒ NO FUNCTIONS&#10;Audit Completed" style="ellipse;whiteSpace=wrap;html=1;fillColor=#ffebee;strokeColor=#c62828;strokeWidth=2;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="880" y="125" width="130" height="60" as="geometry"/>
        </mxCell>

        <!-- ===== PHASE 2: AUDIT ===== -->
        <mxCell id="phase2-label" value="PHASE 2: PARALLEL SECURITY SCANNING (Per Lambda Function)" style="text;html=1;strokeColor=none;fillColor=#f3e5f5;align=center;verticalAlign=middle;fontSize=12;fontStyle=1;fontColor=#6a1b9a;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="50" y="230" width="1100" height="25" as="geometry"/>
        </mxCell>

        <!-- For Each Function -->
        <mxCell id="for-each" value="ðŸ”„ FOR EACH LAMBDA FUNCTION" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e8d5e8;strokeColor=#7b1fa2;strokeWidth=2;fontSize=11;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="270" y="280" width="660" height="30" as="geometry"/>
        </mxCell>

        <!-- ===== CODE SCANNING PATH ===== -->
        <mxCell id="code-path-label" value="CODE SCANNING" style="text;html=1;strokeColor=none;fillColor=#ffccbc;align=center;verticalAlign=middle;fontSize=10;fontStyle=1;fontColor=#d84315;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="70" y="340" width="140" height="20" as="geometry"/>
        </mxCell>

        <mxCell id="get-code" value="1ï¸âƒ£ Download&#10;Function Code" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffccbc;strokeColor=#ff5722;strokeWidth=2;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="70" y="370" width="140" height="70" as="geometry"/>
        </mxCell>

        <mxCell id="extract-code" value="2ï¸âƒ£ Extract &amp;&#10;Prep Files" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffccbc;strokeColor=#ff5722;strokeWidth=2;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="70" y="470" width="140" height="70" as="geometry"/>
        </mxCell>

        <mxCell id="scan-secrets-code" value="ðŸ” Pattern Matching&#10;(AWS Keys, API Tokens,&#10;Passwords, SSH Keys)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffb74d;strokeColor=#ff6f00;strokeWidth=2;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="70" y="570" width="140" height="80" as="geometry"/>
        </mxCell>

        <mxCell id="scan-vulns" value="âš ï¸ Vulnerability&#10;Detection&#10;(SQLi, Injection,&#10;Weak Crypto)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffb74d;strokeColor=#ff6f00;strokeWidth=2;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="70" y="680" width="140" height="100" as="geometry"/>
        </mxCell>

        <!-- ===== ENV VAR SCANNING PATH ===== -->
        <mxCell id="env-path-label" value="ENVIRONMENT VARIABLES" style="text;html=1;strokeColor=none;fillColor=#c8e6c9;align=center;verticalAlign=middle;fontSize=10;fontStyle=1;fontColor=#1b5e20;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="270" y="340" width="140" height="20" as="geometry"/>
        </mxCell>

        <mxCell id="get-env" value="1ï¸âƒ£ Fetch Env&#10;Variables" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#c8e6c9;strokeColor=#2e7d32;strokeWidth=2;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="270" y="370" width="140" height="70" as="geometry"/>
        </mxCell>

        <mxCell id="scan-env-secrets" value="ðŸ”’ Secret Detection&#10;(Password, Token, Key,&#10;Credential patterns)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#81c784;strokeColor=#1b5e20;strokeWidth=2;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="270" y="470" width="140" height="100" as="geometry"/>
        </mxCell>

        <mxCell id="scan-env-creds" value="ðŸ”‘ AWS Credentials&#10;Detection&#10;(AKIA... patterns)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#81c784;strokeColor=#1b5e20;strokeWidth=2;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="270" y="600" width="140" height="100" as="geometry"/>
        </mxCell>

        <!-- ===== IAM ANALYSIS PATH ===== -->
        <mxCell id="iam-path-label" value="IAM &amp; ACCESS" style="text;html=1;strokeColor=none;fillColor=#ffe0b2;align=center;verticalAlign=middle;fontSize=10;fontStyle=1;fontColor=#e65100;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="470" y="340" width="140" height="20" as="geometry"/>
        </mxCell>

        <mxCell id="get-role" value="1ï¸âƒ£ Fetch Lambda&#10;Execution Role" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe0b2;strokeColor=#ff6f00;strokeWidth=2;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="470" y="370" width="140" height="70" as="geometry"/>
        </mxCell>

        <mxCell id="analyze-policies" value="ðŸ“‹ Analyze IAM&#10;Policies" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe0b2;strokeColor=#ff6f00;strokeWidth=2;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="470" y="470" width="140" height="70" as="geometry"/>
        </mxCell>

        <mxCell id="check-overprivileged" value="âš ï¸ Detect Dangerous&#10;Permissions&#10;(s3:*, iam:*,&#10;ec2:*, etc.)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffb74d;strokeColor=#ff6f00;strokeWidth=2;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="470" y="570" width="140" height="100" as="geometry"/>
        </mxCell>

        <mxCell id="check-wildcards" value="ðŸš¨ Check for&#10;Wildcards&#10;(Action:*,&#10;Resource:*)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffb74d;strokeColor=#ff6f00;strokeWidth=2;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="470" y="700" width="140" height="100" as="geometry"/>
        </mxCell>

        <!-- ===== PUBLIC ACCESS PATH ===== -->
        <mxCell id="public-path-label" value="PUBLIC ACCESS" style="text;html=1;strokeColor=none;fillColor=#ffcccc;align=center;verticalAlign=middle;fontSize=10;fontStyle=1;fontColor=#b71c1c;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="670" y="340" width="140" height="20" as="geometry"/>
        </mxCell>

        <mxCell id="get-policy" value="1ï¸âƒ£ Fetch Lambda&#10;Policy" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffcccc;strokeColor=#c62828;strokeWidth=2;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="670" y="370" width="140" height="70" as="geometry"/>
        </mxCell>

        <mxCell id="check-principal" value="ðŸŒ Check Principal&#10;for &#34;*&#34; or&#10;unauthenticated" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ef9a9a;strokeColor=#c62828;strokeWidth=2;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="670" y="470" width="140" height="100" as="geometry"/>
        </mxCell>

        <mxCell id="flag-public" value="ðŸš© Mark as&#10;PUBLICLY&#10;ACCESSIBLE" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e57373;strokeColor=#b71c1c;strokeWidth=2;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="670" y="600" width="140" height="100" as="geometry"/>
        </mxCell>

        <!-- ===== PHASE 3: AGGREGATION ===== -->
        <mxCell id="phase3-label" value="PHASE 3: FINDINGS AGGREGATION" style="text;html=1;strokeColor=none;fillColor=#e1f5fe;align=center;verticalAlign=middle;fontSize=12;fontStyle=1;fontColor=#01579b;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="50" y="840" width="1100" height="25" as="geometry"/>
        </mxCell>

        <!-- Aggregate Findings -->
        <mxCell id="aggregate" value="ðŸ“Š Aggregate Findings&#10;(Collect from all functions)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#b3e5fc;strokeColor=#01579b;strokeWidth=2;fontSize=11;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="200" y="890" width="240" height="70" as="geometry"/>
        </mxCell>

        <!-- Categorize -->
        <mxCell id="categorize" value="ðŸ·ï¸ Categorize By:&#10;Severity (Critical/High/Low)&#10;Type (Secret/IAM/Access/etc.)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#b3e5fc;strokeColor=#01579b;strokeWidth=2;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="520" y="890" width="240" height="70" as="geometry"/>
        </mxCell>

        <!-- ===== PHASE 4: REPORTING ===== -->
        <mxCell id="phase4-label" value="PHASE 4: REPORTING &amp; OUTPUT" style="text;html=1;strokeColor=none;fillColor=#f1f8e9;align=center;verticalAlign=middle;fontSize=12;fontStyle=1;fontColor=#33691e;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="50" y="990" width="1100" height="25" as="geometry"/>
        </mxCell>

        <!-- JSON Report -->
        <mxCell id="json-report" value="ðŸ“„ JSON Report&#10;(Technical Details)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dcedc8;strokeColor=#558b2f;strokeWidth=2;fontSize=11;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="120" y="1040" width="160" height="70" as="geometry"/>
        </mxCell>

        <!-- CSV Report -->
        <mxCell id="csv-report" value="ðŸ“Š CSV Report&#10;(Spreadsheet Format)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dcedc8;strokeColor=#558b2f;strokeWidth=2;fontSize=11;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="370" y="1040" width="160" height="70" as="geometry"/>
        </mxCell>

        <!-- HTML Report -->
        <mxCell id="html-report" value="ðŸŒ HTML Report&#10;(Visual Presentation)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dcedc8;strokeColor=#558b2f;strokeWidth=2;fontSize=11;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="620" y="1040" width="160" height="70" as="geometry"/>
        </mxCell>

        <!-- Summary -->
        <mxCell id="summary" value="âœ… AUDIT COMPLETE&#10;All reports saved to findings/" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#9ccc65;strokeColor=#33691e;strokeWidth=2;fontSize=11;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="870" y="1040" width="160" height="70" as="geometry"/>
        </mxCell>

        <!-- ===== CONNECTORS ===== -->

        <!-- PHASE 1 -->
        <mxCell id="e1" edge="1" source="load-config" target="init-aws" parent="1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e2" edge="1" source="init-aws" target="list-funcs" parent="1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e3" edge="1" source="list-funcs" target="decision-funcs" parent="1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e4" edge="1" source="decision-funcs" target="end-empty" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="810" y="155" as="targetPoint"/>
          </mxGeometry>
        </mxCell>
        <mxCell id="e5" edge="1" source="decision-funcs" target="for-each" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="600" y="310" as="targetPoint"/>
          </mxGeometry>
        </mxCell>

        <!-- CODE SCANNING FLOW -->
        <mxCell id="e6" edge="1" source="for-each" target="get-code" parent="1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e7" edge="1" source="get-code" target="extract-code" parent="1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e8" edge="1" source="extract-code" target="scan-secrets-code" parent="1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e9" edge="1" source="scan-secrets-code" target="scan-vulns" parent="1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <!-- ENV VAR FLOW -->
        <mxCell id="e10" edge="1" source="for-each" target="get-env" parent="1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e11" edge="1" source="get-env" target="scan-env-secrets" parent="1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e12" edge="1" source="scan-env-secrets" target="scan-env-creds" parent="1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <!-- IAM FLOW -->
        <mxCell id="e13" edge="1" source="for-each" target="get-role" parent="1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e14" edge="1" source="get-role" target="analyze-policies" parent="1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e15" edge="1" source="analyze-policies" target="check-overprivileged" parent="1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e16" edge="1" source="check-overprivileged" target="check-wildcards" parent="1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <!-- PUBLIC ACCESS FLOW -->
        <mxCell id="e17" edge="1" source="for-each" target="get-policy" parent="1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e18" edge="1" source="get-policy" target="check-principal" parent="1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e19" edge="1" source="check-principal" target="flag-public" parent="1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <!-- AGGREGATION -->
        <mxCell id="e20" edge="1" source="scan-vulns" target="aggregate" style="strokeDasharray=3 3;" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="320" y="850" as="targetPoint"/>
          </mxGeometry>
        </mxCell>
        <mxCell id="e21" edge="1" source="scan-env-creds" target="aggregate" style="strokeDasharray=3 3;" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="320" y="850" as="targetPoint"/>
          </mxGeometry>
        </mxCell>
        <mxCell id="e22" edge="1" source="check-wildcards" target="aggregate" style="strokeDasharray=3 3;" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="320" y="850" as="targetPoint"/>
          </mxGeometry>
        </mxCell>
        <mxCell id="e23" edge="1" source="flag-public" target="aggregate" style="strokeDasharray=3 3;" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="320" y="850" as="targetPoint"/>
          </mxGeometry>
        </mxCell>

        <!-- CATEGORIZE -->
        <mxCell id="e24" edge="1" source="aggregate" target="categorize" parent="1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <!-- REPORTS -->
        <mxCell id="e25" edge="1" source="categorize" target="json-report" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="200" y="1040" as="targetPoint"/>
          </mxGeometry>
        </mxCell>
        <mxCell id="e26" edge="1" source="categorize" target="csv-report" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="450" y="1040" as="targetPoint"/>
          </mxGeometry>
        </mxCell>
        <mxCell id="e27" edge="1" source="categorize" target="html-report" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="700" y="1040" as="targetPoint"/>
          </mxGeometry>
        </mxCell>
        <mxCell id="e28" edge="1" source="categorize" target="summary" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="950" y="1040" as="targetPoint"/>
          </mxGeometry>
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
