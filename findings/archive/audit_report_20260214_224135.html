
        <!DOCTYPE html>
        <html>
        <head>
            <title>Lambda Security Audit Report</title>
            <style>
                body { font-family: Arial, sans-serif; margin: 20px; }
                h1 { color: #333; }
                .summary { background: #f0f0f0; padding: 15px; border-radius: 5px; margin: 20px 0; }
                .finding { 
                    border-left: 4px solid #ccc;
                    padding: 10px;
                    margin: 10px 0;
                    background: #fafafa;
                }
                .finding.CRITICAL { border-left-color: #d32f2f; }
                .finding.HIGH { border-left-color: #f57c00; }
                .finding.MEDIUM { border-left-color: #fbc02d; }
                .finding.LOW { border-left-color: #388e3c; }
                .severity { 
                    display: inline-block;
                    padding: 3px 8px;
                    border-radius: 3px;
                    font-weight: bold;
                    color: white;
                    margin-right: 10px;
                }
                .CRITICAL { background: #d32f2f; }
                .HIGH { background: #f57c00; }
                .MEDIUM { background: #fbc02d; color: #333; }
                .LOW { background: #388e3c; }
                table { border-collapse: collapse; width: 100%; margin-top: 20px; }
                th, td { border: 1px solid #ddd; padding: 10px; text-align: left; }
                th { background-color: #333; color: white; }
                tr:nth-child(even) { background-color: #f2f2f2; }
            </style>
        </head>
        <body>
            <h1>Lambda Security Audit Report</h1>
            <p>Generated: 2026-02-14 22:41:35</p>
            
            <div class="summary">
                <h2>Summary</h2>
                <p><strong>Total Findings:</strong> 11</p>
                <p><strong>Critical/High:</strong> 7</p>
            </div>
            
            <h2>Findings Details</h2>
            <table>
                <tr>
                    <th>Type</th>
                    <th>Severity</th>
                    <th>Message</th>
                    <th>Source</th>
                    <th>Function</th>
                </tr>
        
                <tr>
                    <td>VULNERABILITY</td>
                    <td><span class="severity HIGH">HIGH</span></td>
                    <td>Potential SQL Injection vulnerability</td>
                    <td>code_scan</td>
                    <td>api-gateway-backend</td>
                </tr>
            
                <tr>
                    <td>VULNERABILITY</td>
                    <td><span class="severity HIGH">HIGH</span></td>
                    <td>Potential Command Injection vulnerability</td>
                    <td>code_scan</td>
                    <td>api-gateway-backend</td>
                </tr>
            
                <tr>
                    <td>IAM_ERROR</td>
                    <td><span class="severity LOW">LOW</span></td>
                    <td>Failed to analyze IAM: Failed to get policies for role ScopedLambdaExecutionRole: An error occurred (AccessDenied) when calling the ListRolePolicies operation: User: arn:aws:iam::014498641736:user/LambdaSecurityAssessmentUser is not authorized to perform: iam:ListRolePolicies on resource: role ScopedLambdaExecutionRole because no identity-based policy allows the iam:ListRolePolicies action</td>
                    <td>iam_error</td>
                    <td>api-gateway-backend</td>
                </tr>
            
                <tr>
                    <td>IAM_ERROR</td>
                    <td><span class="severity LOW">LOW</span></td>
                    <td>Failed to analyze IAM: Failed to get policies for role ScopedLambdaExecutionRole: An error occurred (AccessDenied) when calling the ListRolePolicies operation: User: arn:aws:iam::014498641736:user/LambdaSecurityAssessmentUser is not authorized to perform: iam:ListRolePolicies on resource: role ScopedLambdaExecutionRole because no identity-based policy allows the iam:ListRolePolicies action</td>
                    <td>iam_error</td>
                    <td>file-processor</td>
                </tr>
            
                <tr>
                    <td>SECRET</td>
                    <td><span class="severity CRITICAL">CRITICAL</span></td>
                    <td>Potential Database Password found</td>
                    <td>code_scan</td>
                    <td>database-connector</td>
                </tr>
            
                <tr>
                    <td>VULNERABILITY</td>
                    <td><span class="severity HIGH">HIGH</span></td>
                    <td>Potential SQL Injection vulnerability</td>
                    <td>code_scan</td>
                    <td>database-connector</td>
                </tr>
            
                <tr>
                    <td>VULNERABILITY</td>
                    <td><span class="severity HIGH">HIGH</span></td>
                    <td>Potential SQL Injection vulnerability</td>
                    <td>code_scan</td>
                    <td>database-connector</td>
                </tr>
            
                <tr>
                    <td>IAM_ERROR</td>
                    <td><span class="severity LOW">LOW</span></td>
                    <td>Failed to analyze IAM: Failed to get policies for role ScopedLambdaExecutionRole: An error occurred (AccessDenied) when calling the ListRolePolicies operation: User: arn:aws:iam::014498641736:user/LambdaSecurityAssessmentUser is not authorized to perform: iam:ListRolePolicies on resource: role ScopedLambdaExecutionRole because no identity-based policy allows the iam:ListRolePolicies action</td>
                    <td>iam_error</td>
                    <td>database-connector</td>
                </tr>
            
                <tr>
                    <td>VULNERABILITY</td>
                    <td><span class="severity HIGH">HIGH</span></td>
                    <td>Potential SQL Injection vulnerability</td>
                    <td>code_scan</td>
                    <td>public-data-api</td>
                </tr>
            
                <tr>
                    <td>IAM_ERROR</td>
                    <td><span class="severity LOW">LOW</span></td>
                    <td>Failed to analyze IAM: Failed to get policies for role ScopedLambdaExecutionRole: An error occurred (AccessDenied) when calling the ListRolePolicies operation: User: arn:aws:iam::014498641736:user/LambdaSecurityAssessmentUser is not authorized to perform: iam:ListRolePolicies on resource: role ScopedLambdaExecutionRole because no identity-based policy allows the iam:ListRolePolicies action</td>
                    <td>iam_error</td>
                    <td>public-data-api</td>
                </tr>
            
                <tr>
                    <td>PUBLIC_ACCESS</td>
                    <td><span class="severity CRITICAL">CRITICAL</span></td>
                    <td>Lambda function public-data-api is publicly accessible</td>
                    <td>public_access</td>
                    <td>public-data-api</td>
                </tr>
            
            </table>
        </body>
        </html>
        