[
  {
    "type": "VULNERABILITY",
    "severity": "HIGH",
    "vuln_type": "SQL Injection",
    "file": "index.py",
    "line": 16,
    "message": "Potential SQL Injection vulnerability",
    "source": "code_scan",
    "timestamp": "2026-02-14T22:55:21.720976",
    "function": "api-gateway-backend"
  },
  {
    "type": "VULNERABILITY",
    "severity": "HIGH",
    "vuln_type": "Command Injection",
    "file": "index.py",
    "line": 15,
    "message": "Potential Command Injection vulnerability",
    "source": "code_scan",
    "timestamp": "2026-02-14T22:55:21.720984",
    "function": "api-gateway-backend"
  },
  {
    "type": "IAM_ERROR",
    "severity": "LOW",
    "message": "Failed to analyze IAM: Failed to get policies for role ScopedLambdaExecutionRole: An error occurred (AccessDenied) when calling the ListRolePolicies operation: User: arn:aws:iam::014498641736:user/LambdaSecurityAssessmentUser is not authorized to perform: iam:ListRolePolicies on resource: role ScopedLambdaExecutionRole because no identity-based policy allows the iam:ListRolePolicies action",
    "source": "iam_error",
    "timestamp": "2026-02-14T22:55:22.268771",
    "function": "api-gateway-backend"
  },
  {
    "type": "IAM_ERROR",
    "severity": "LOW",
    "message": "Failed to analyze IAM: Failed to get policies for role ScopedLambdaExecutionRole: An error occurred (AccessDenied) when calling the ListRolePolicies operation: User: arn:aws:iam::014498641736:user/LambdaSecurityAssessmentUser is not authorized to perform: iam:ListRolePolicies on resource: role ScopedLambdaExecutionRole because no identity-based policy allows the iam:ListRolePolicies action",
    "source": "iam_error",
    "timestamp": "2026-02-14T22:55:23.571659",
    "function": "file-processor"
  },
  {
    "type": "SECRET",
    "severity": "CRITICAL",
    "secret_type": "Database Password",
    "file": "index.py",
    "line": 6,
    "message": "Potential Database Password found",
    "match": "password: {os.environ.get(",
    "source": "code_scan",
    "timestamp": "2026-02-14T22:55:24.683688",
    "function": "database-connector"
  },
  {
    "type": "VULNERABILITY",
    "severity": "HIGH",
    "vuln_type": "SQL Injection",
    "file": "index.py",
    "line": 6,
    "message": "Potential SQL Injection vulnerability",
    "source": "code_scan",
    "timestamp": "2026-02-14T22:55:24.683696",
    "function": "database-connector"
  },
  {
    "type": "VULNERABILITY",
    "severity": "HIGH",
    "vuln_type": "SQL Injection",
    "file": "index.py",
    "line": 7,
    "message": "Potential SQL Injection vulnerability",
    "source": "code_scan",
    "timestamp": "2026-02-14T22:55:24.683698",
    "function": "database-connector"
  },
  {
    "type": "EXPOSED_SECRET_VAR",
    "severity": "CRITICAL",
    "message": "Potentially sensitive environment variable exposed: API_KEY",
    "variable_name": "API_KEY",
    "variable_value": "AKIAIOSFODNN7EXAMPLE",
    "function": "database-connector",
    "source": "env_scan",
    "timestamp": "2026-02-14T22:55:24.684689"
  },
  {
    "type": "AWS_CREDENTIALS",
    "severity": "CRITICAL",
    "message": "AWS credentials found in environment variable: API_KEY",
    "variable_name": "API_KEY",
    "variable_value": "AKIAIOSFODNN7EXAMPLE",
    "function": "database-connector",
    "source": "env_scan",
    "timestamp": "2026-02-14T22:55:24.684692"
  },
  {
    "type": "EXPOSED_SECRET_VALUE",
    "severity": "CRITICAL",
    "message": "Exposed secret in DATABASE_URL",
    "variable_name": "DATABASE_URL",
    "variable_value": "postgresql://admin:password@db.example.com:5432/pr",
    "function": "database-connector",
    "source": "env_scan",
    "timestamp": "2026-02-14T22:55:24.684694"
  },
  {
    "type": "EXPOSED_SECRET_VAR",
    "severity": "CRITICAL",
    "message": "Potentially sensitive environment variable exposed: JWT_SECRET",
    "variable_name": "JWT_SECRET",
    "variable_value": "super_secret_jwt_key_do_not_share",
    "function": "database-connector",
    "source": "env_scan",
    "timestamp": "2026-02-14T22:55:24.684695"
  },
  {
    "type": "EXPOSED_SECRET_VALUE",
    "severity": "CRITICAL",
    "message": "Exposed secret in JWT_SECRET",
    "variable_name": "JWT_SECRET",
    "variable_value": "super_secret_jwt_key_do_not_share",
    "function": "database-connector",
    "source": "env_scan",
    "timestamp": "2026-02-14T22:55:24.684697"
  },
  {
    "type": "EXPOSED_SECRET_VAR",
    "severity": "CRITICAL",
    "message": "Potentially sensitive environment variable exposed: ENCRYPTION_KEY",
    "variable_name": "ENCRYPTION_KEY",
    "variable_value": "AES256_KEY_FOR_ENCRYPTION",
    "function": "database-connector",
    "source": "env_scan",
    "timestamp": "2026-02-14T22:55:24.684698"
  },
  {
    "type": "EXPOSED_SECRET_VALUE",
    "severity": "CRITICAL",
    "message": "Exposed secret in ENCRYPTION_KEY",
    "variable_name": "ENCRYPTION_KEY",
    "variable_value": "AES256_KEY_FOR_ENCRYPTION",
    "function": "database-connector",
    "source": "env_scan",
    "timestamp": "2026-02-14T22:55:24.684699"
  },
  {
    "type": "EXPOSED_SECRET_VAR",
    "severity": "CRITICAL",
    "message": "Potentially sensitive environment variable exposed: DB_PASSWORD",
    "variable_name": "DB_PASSWORD",
    "variable_value": "SuperSecretPassword123!",
    "function": "database-connector",
    "source": "env_scan",
    "timestamp": "2026-02-14T22:55:24.684701"
  },
  {
    "type": "IAM_ERROR",
    "severity": "LOW",
    "message": "Failed to analyze IAM: Failed to get policies for role ScopedLambdaExecutionRole: An error occurred (AccessDenied) when calling the ListRolePolicies operation: User: arn:aws:iam::014498641736:user/LambdaSecurityAssessmentUser is not authorized to perform: iam:ListRolePolicies on resource: role ScopedLambdaExecutionRole because no identity-based policy allows the iam:ListRolePolicies action",
    "source": "iam_error",
    "timestamp": "2026-02-14T22:55:24.817891",
    "function": "database-connector"
  },
  {
    "type": "VULNERABILITY",
    "severity": "HIGH",
    "vuln_type": "SQL Injection",
    "file": "index.py",
    "line": 16,
    "message": "Potential SQL Injection vulnerability",
    "source": "code_scan",
    "timestamp": "2026-02-14T22:55:25.930692",
    "function": "public-data-api"
  },
  {
    "type": "DEBUG_MODE",
    "severity": "HIGH",
    "message": "Debug mode is enabled - may leak sensitive information",
    "variable_name": "DEBUG_MODE",
    "variable_value": "true",
    "function": "public-data-api",
    "source": "env_scan",
    "timestamp": "2026-02-14T22:55:25.931202"
  },
  {
    "type": "IAM_ERROR",
    "severity": "LOW",
    "message": "Failed to analyze IAM: Failed to get policies for role ScopedLambdaExecutionRole: An error occurred (AccessDenied) when calling the ListRolePolicies operation: User: arn:aws:iam::014498641736:user/LambdaSecurityAssessmentUser is not authorized to perform: iam:ListRolePolicies on resource: role ScopedLambdaExecutionRole because no identity-based policy allows the iam:ListRolePolicies action",
    "source": "iam_error",
    "timestamp": "2026-02-14T22:55:26.077818",
    "function": "public-data-api"
  },
  {
    "type": "PUBLIC_ACCESS",
    "severity": "CRITICAL",
    "message": "Lambda function public-data-api is publicly accessible",
    "function": "public-data-api",
    "source": "public_access",
    "timestamp": "2026-02-14T22:55:26.227000"
  }
]